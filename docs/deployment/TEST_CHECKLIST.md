# 全球联网排行榜功能测试清单

## 测试环境
- 浏览器：Chrome/Firefox/Safari（推荐使用最新版本）
- 本地服务器：`python -m http.server 8000`
- GitHub 账号：需要用于提交 Issue

## 测试场景

### 场景 1：基础UI测试 ✅

#### 1.1 主页面按钮显示
- [ ] 打开 `index.html`
- [ ] 检查左上角是否显示"排行榜"按钮
- [ ] 检查"排行榜"按钮左侧，"单通时间计时"按钮右侧
- [ ] 两个按钮是否并排显示，间距合理

#### 1.2 计时器弹窗按钮
- [ ] 点击"单通时间计时"按钮
- [ ] 检查是否显示三个按钮："保存到本地"、"上传全球榜"、"查看排行榜"
- [ ] 按钮布局是否正常

#### 1.3 排行榜页面标签页
- [ ] 点击"排行榜"按钮，跳转到排行榜页面
- [ ] 检查是否显示两个标签页："部门记录（本地）"、"都市广播（联网）"
- [ ] 默认是否选中"部门记录（本地）"标签
- [ ] 点击标签页能否正常切换

---

### 场景 2：本地排行榜功能测试 ✅

#### 2.1 保存记录到本地
- [ ] 回到主页面，完成罪人和人格抽取
- [ ] 打开计时器，开始计时（至少10秒）
- [ ] 点击"暂停"
- [ ] 填写备注（如"测试记录"）
- [ ] 点击"保存到本地"
- [ ] 检查是否弹出"保存成功"提示

#### 2.2 查看本地排行榜
- [ ] 点击"查看排行榜"或主页面的"排行榜"按钮
- [ ] 在"部门记录（本地）"标签页中是否显示刚才的记录
- [ ] 检查记录格式：
  - [ ] 排名序号显示正确
  - [ ] 罪人头像和名字显示正确
  - [ ] 人格名称显示正确
  - [ ] 通关时间格式为 HH:MM:SS
  - [ ] 备注内容显示正确

#### 2.3 清空本地记录
- [ ] 点击"清空本地记录"按钮
- [ ] 检查是否弹出确认对话框
- [ ] 点击"确定"
- [ ] 检查列表是否显示"暂无记录"

---

### 场景 3：联网排行榜数据加载测试 ✅

#### 3.1 空数据显示
- [ ] 切换到"都市广播（联网）"标签页
- [ ] 如果是首次使用，应显示"暂无全球排行榜记录"
- [ ] 检查加载提示是否正常显示和消失

#### 3.2 数据显示格式（如果有数据）
- [ ] 检查是否按罪人分组显示
- [ ] 每个罪人下是否按人格分组
- [ ] 每组内记录是否按时间从快到慢排序
- [ ] 记录格式是否正确

#### 3.3 刷新数据
- [ ] 点击"刷新数据"按钮
- [ ] 检查是否重新加载数据
- [ ] 加载过程中是否显示加载提示

---

### 场景 4：上传全球排行榜验证测试 ✅

#### 4.1 未选择罪人/人格时上传
- [ ] 打开计时器，开始计时并暂停
- [ ] 不进行罪人和人格抽取
- [ ] 点击"上传全球榜"
- [ ] 检查是否提示"需要先抽取罪人和人格"
- [ ] 点击"确定"后是否关闭计时器弹窗

#### 4.2 时间不足1小时时上传
- [ ] 完成罪人和人格抽取
- [ ] 计时少于3600秒（如500秒）
- [ ] 点击"上传全球榜"
- [ ] 检查是否提示"只有通关时间≥1小时的记录才能上传"

#### 4.3 正常上传流程
- [ ] 完成罪人和人格抽取（记录罪人和人格信息）
- [ ] 计时超过3600秒（或手动修改代码测试）
- [ ] 填写备注
- [ ] 点击"上传全球榜"
- [ ] 检查确认对话框内容：
  - [ ] 罪人名称是否正确
  - [ ] 人格名称是否正确
  - [ ] 时间格式是否正确（HH:MM:SS）
  - [ ] 备注是否正确
- [ ] 点击"确定"
- [ ] 检查是否在新窗口打开 GitHub Issue 页面
- [ ] 检查 Issue 标题是否包含罪人、人格和时间信息
- [ ] （注意：需要替换 `repoOwner` 和 `repoName` 为实际值）

---

### 场景 5：GitHub Actions 和数据聚合测试 ⚠️

**注意**：此部分需要在 GitHub 仓库中测试

#### 5.1 Issue 模板测试
- [ ] 在 GitHub 仓库中点击 "Issues" → "New issue"
- [ ] 检查是否显示"提交通关记录"模板
- [ ] 点击模板，检查表单字段是否完整
- [ ] 尝试提交一条测试记录

#### 5.2 Actions 工作流测试
- [ ] 前往仓库的 Actions 页面
- [ ] 检查是否有"Update Global Ranking"工作流
- [ ] 手动触发工作流（点击 "Run workflow"）
- [ ] 检查工作流是否成功运行
- [ ] 检查 `data/global-ranking.json` 文件是否更新

#### 5.3 数据聚合脚本测试
- [ ] 在本地运行：`node scripts/generate-global-ranking.mjs`
- [ ] （需要设置 `GITHUB_TOKEN` 和 `GITHUB_REPOSITORY` 环境变量）
- [ ] 检查脚本是否正确读取 Issues
- [ ] 检查生成的 JSON 文件格式是否正确

---

### 场景 6：边界情况和错误处理测试 ✅

#### 6.1 网络错误处理
- [ ] 断开网络连接
- [ ] 切换到"都市广播（联网）"标签页
- [ ] 检查是否显示加载失败提示
- [ ] 错误信息是否友好

#### 6.2 未选择罪人时的显示
- [ ] 不进行罪人抽取，直接计时并保存
- [ ] 查看本地排行榜
- [ ] 检查是否显示"未选择罪人"和"未选择人格"

#### 6.3 返回主页按钮
- [ ] 在排行榜页面点击"返回主页"按钮
- [ ] 检查是否正确跳转回主页面

---

## 已知问题和注意事项

### ⚠️ 需要手动配置的部分

1. **GitHub 仓库信息**
   - 文件：`js/common.js`
   - 行号：约第274-275行
   - 需要修改：
     ```javascript
     const repoOwner = 'your-username'; // 替换为实际的 GitHub 用户名
     const repoName = 'lam'; // 替换为实际的仓库名
     ```

2. **GitHub Actions 权限**
   - 确保仓库启用了 GitHub Actions
   - 确保 Actions 有写入仓库的权限
   - Settings → Actions → General → Workflow permissions → Read and write permissions

3. **Issue 标签**
   - 需要手动创建"通关记录"和"已处理"标签

### ✅ 测试通过标准

- [ ] 所有 UI 元素正常显示
- [ ] 本地排行榜功能完全正常
- [ ] 联网排行榜能正常加载数据
- [ ] 上传验证逻辑正确
- [ ] 错误处理友好
- [ ] 所有按钮和链接都能正常工作

---

## 测试报告模板

**测试日期**：_________  
**测试人员**：_________  
**测试环境**：_________  

**测试结果**：
- 通过数量：_____ / 总数
- 失败数量：_____
- 阻塞问题：_____

**详细问题记录**：
1. 
2. 
3. 

**建议改进**：
1. 
2. 
3.
